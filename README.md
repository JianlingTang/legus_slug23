### The SLUG Bayesian Modelling of LEGUS Cluster Demographics Pipeline (2023)

## Dependencies 

1. Install the slug source code from https://bitbucket.org/krumholz/slug2/src/master/ before using any of the analytical Python tools in this directory.

2. Include Dan Foreman-Mackey's emcee package from https://github.com/dfm/emcee.

3. The library files needed for the analysis can be obtained upon request from the corresponding author. Due to limited space, they will be provided in a compressed file format (tarball of approximately 64GB).

## Repository Workflow:

1. Download the cluster catalog files from public data. The NGC 628 c and e cluster catalogs are located in the /cluster_catalogs directory.

2. Run `analyze_catalog_mid_midd.py` by typing `./analyze_catalog_mid_mdd.sh` in the main directory. This will produce the chains resulting from running the MCMC trials. The previous chains returned by running the analyzing scripts are included. The shell scripts contain the absolute paths of each input data file. You'll need to update the paths and filenames according to your own directory names.

3. Generate the plots using `plot_mag.py`, `plot_color_mag.py`, and `plot_stack.py`. These scripts generate all plots appearing in the paper.


## Layout 

`chains/`: directory of the MCMC chains returned by running the `analyze_catalog_mid_mdd.py` and `analyze_divide.py`.

`cluster_catalogs/`: directory of the input cluster catalog files of the galaxy.

`completeness_data/`: directory of all the pre-computed completeness values of the library and the observations. These files can be generated by using the functions in `completeness_calculators.py`.

`phot_pct/`: directory of the pre-computed luminosity PDFs at different percentiles.

`analyze_catalog_mid_mdd.py`: performs the MCMC optimization of the model parameters.

`analyze_catalog_mid_mdd.sh`: executes the `analyze_catalog_mid_mdd.py` script with arguments.

`analyze_divide.py`: performs the MCMC optimization of the model parameters by grouping the full catalog using different criteria.

`catalog_readers.py`: reads the catalog file and organizes them.

`completeness_calculators.py`: calculates the completeness values given a set of input photometry.

`divide_legus.py`: script that divides the full catalog into sub-groups.

`plot_color_mag.py`: plots the PDFs of color versus magnitudes.

`plot_color_mag.sh`: runs the `plot_color_mag.py` with specified arguments.

`plot_mag.py`: plots the PDFs of magnitudes in various filters.

`plot_mag.sh`: runs the `plot_mag.py` with specified arguments.

`plot_stack.py`: plots the comparison of sub-groups of the cluster demographics.

`plot_stack.sh`: script that runs the `plot_stack.py` with specified arguments.

`make_lib.param`: This parameter file is used to run an SLUG simulation that creates 10^7 clusters in the library.

`lib_av.pdf, lib_mass.pdf, lib_time.pdf`: These parameter files define the distinction (AV), mass, and age shapes and are required inputs for creating the SLUG library.


## License 

This code distributed under the GNU 3.0 license. 